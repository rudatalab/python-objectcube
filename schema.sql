drop table if exists OBJECTS;
drop table if exists DIMENSIONS;
drop table if exists TAGS;
drop table if exists PLUGINS;

CREATE TABLE PLUGINS (
    ID SERIAL PRIMARY KEY NOT NULL,
    NAME VARCHAR(128) NOT NULL UNIQUE,
    MODULE VARCHAR(128) NOT NULL UNIQUE
);

CREATE TABLE TAGS (
    ID SERIAL PRIMARY KEY NOT NULL,
    VALUE VARCHAR(128) NOT NULL,
    DESCRIPTION VARCHAR(128) DEFAULT '',
    MUTABLE BOOL DEFAULT TRUE,
    TYPE INT NOT NULL,
    PLUGIN_ID INT NULL,
    FOREIGN KEY(PLUGIN_ID) REFERENCES PLUGINS(ID)
);

CREATE TABLE OBJECTS (
    ID SERIAL PRIMARY KEY NOT NULL,
    NAME VARCHAR(128) NOT NULL,
    DIGEST VARCHAR(128) NOT NULL,
    CONSTRAINT OBJECTS_UNIQUE_NAME_DIGEST UNIQUE (NAME, DIGEST)
);

CREATE TABLE DIMENSIONS (
    ID SERIAL PRIMARY KEY NOT NULL,
    NAME VARCHAR(128) NOT NULL,
    TREE TEXT NOT NULL
);